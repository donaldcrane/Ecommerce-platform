{"version":3,"sources":["../../src/utilities/jwt.js"],"names":["User","require","jwt","config","module","exports","req","res","next","authorization","headers","token","split","decoded","verify","process","env","TOKEN_SECRET","status","json","error"],"mappings":";;;;;;;;;;;;AAAA,IAAMA,IAAI,GAAGC,OAAO,CAAC,gBAAD,CAApB;;AACA,IAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB;;AAEAA,OAAO,CAAC,QAAD,CAAP,CAAkBE,MAAlB;;AAGAC,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,wHAE4BC,GAF5B,EAEiCC,GAFjC,EAEsCC,IAFtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIcC,gBAAAA,aAJd,GAIgCH,GAAG,CAACI,OAJpC,CAIcD,aAJd;;AAAA,qBAMUA,aANV;AAAA;AAAA;AAAA;;AAOYE,gBAAAA,KAPZ,GAOoBF,aAAa,CAACG,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAPpB;AAQMC,gBAAAA,OAAO,GAAGX,GAAG,CAACY,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,CAAV;AACAX,gBAAAA,GAAG,CAACO,OAAJ,GAAcA,OAAd;AATN,iDAUaL,IAAI,EAVjB;;AAAA;AAAA,iDAYWD,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAED,kBAAAA,MAAM,EAAE,GAAV;AAAeE,kBAAAA,KAAK,EAAE;AAAtB,iBAArB,CAZX;;AAAA;AAAA;AAAA;AAAA,iDAcWb,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAED,kBAAAA,MAAM,EAAE,GAAV;AAAeE,kBAAAA,KAAK,EAAE;AAAtB,iBAArB,CAdX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const User = require(\"../models/User\");\r\nconst jwt = require(\"jsonwebtoken\");\r\n\r\nrequire(\"dotenv\").config();\r\n\r\n\r\nmodule.exports = class Auth {\r\n\r\n  static async verifyToken (req, res, next) {\r\n    try{\r\n      const { authorization } = req.headers;\r\n      let decoded;\r\n      if (authorization) {\r\n      const token = authorization.split(\" \")[1];\r\n      decoded = jwt.verify(token, process.env.TOKEN_SECRET);\r\n      req.decoded = decoded;\r\n      return next();\r\n    }\r\n    return res.status(401).json({ status: 401, error: \"Please login.\" });\r\n  } catch (error) {\r\n    return res.status(500).json({ status: 500, error: \"Server Error.\" });\r\n  }}\r\n}\r\n"],"file":"jwt.js"}